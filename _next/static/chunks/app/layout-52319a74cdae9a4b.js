(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{5966:(e,t,r)=>{Promise.resolve().then(r.bind(r,7366))},7366:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(5155),o=r(2115),n=r(5398);function a(e){let{children:t}=e;return(0,o.useEffect)(()=>{sessionStorage.getItem("User")&&(0,n._f)()},[]),(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{children:t})})}r(347)},5398:(e,t,r)=>{"use strict";r.d(t,{_f:()=>n,dG:()=>a,in:()=>o});let s=null,o=()=>{let e=localStorage.getItem("User"),t=sessionStorage.getItem("User");return e&&!t?(sessionStorage.setItem("User",e),JSON.parse(e)):t?JSON.parse(t):null},n=()=>{s&&clearInterval(s);let e=async()=>{try{let e=o();if(!e||!e.refreshToken)throw Error("No valid refresh token found");let t=await fetch("".concat("https://aistestingbackend-production.up.railway.app","/refresh"),{method:"POST",headers:{Authorization:"Bearer ".concat(e.refreshToken),"Content-Type":"application/json"}});if(t.ok){let r=await t.json();if(!r.access_token)throw Error("Invalid token response");let s={...e,token:r.access_token,refreshToken:r.refresh_token||e.refreshToken};sessionStorage.setItem("User",JSON.stringify(s)),localStorage.getItem("User")&&localStorage.setItem("User",JSON.stringify(s))}else clearInterval(s),sessionStorage.removeItem("User"),localStorage.removeItem("User"),window.history.pushState({},"","/login"),window.dispatchEvent(new PopStateEvent("popstate"))}catch(e){console.error("Token refresh failed:",e),clearInterval(s),sessionStorage.removeItem("User"),localStorage.removeItem("User"),console.error("Refresh error details:",{error:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString(),status:e instanceof Response?e.status:"unknown"}),window.history.pushState({},"","/login"),window.dispatchEvent(new PopStateEvent("popstate"))}};s=setInterval(e,36e5),e()},a=()=>{let e=localStorage.getItem("User")||sessionStorage.getItem("User");if(!e)return null;try{return JSON.parse(e).token}catch(e){return console.error("Error parsing user data:",e),null}}},347:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[690,441,517,358],()=>t(5966)),_N_E=e.O()}]);